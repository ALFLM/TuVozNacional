<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contáctanos - Tu Voz</title>
  <link rel="stylesheet" href="style_form.css">
  <!-- Agregar Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body>
    <header>
        <h1>TuVoz: feedback</h1>
        <p>Déjanos tus comentarios, sugerencias o recomendaciones sobre nuestra página web.</p>
        <nav class="navegacion-enlaces">
            <a href="index.html" class="volver">← Volver a Inicio</a>
        </nav>
    </header>

  <div class="container">
    <h1>Contáctanos</h1>

    <!-- Formulario de contacto -->
    <form id="contactForm">
      <label for="name">Nombre:</label>
      <input type="text" id="name" name="name" required>

      <label for="email">Correo electrónico:</label>
      <input type="email" id="email" name="email">

      <label for="message">Mensaje:</label>
      <textarea id="message" name="message" rows="5" required></textarea>

      <button type="submit">Enviar</button>
    </form>

    <!-- Mensajes de éxito o error -->
    <div id="messageSuccess" class="message success"></div>
    <div id="messageError" class="message error"></div>
  </div>

  <script>

import { initializeApp } from 'firebase/app';
import { getFirestore, collection, addDoc } from 'firebase/firestore';
    // Configuración de Firebase
const firebaseConfig = {
  apiKey: "AIzaSyCYLtf51vBg0NmXoEMD64KbNcU1Izhoc6M",
  authDomain: "tuvoz-dae95.firebaseapp.com",
  databaseURL: "https://tuvoz-dae95-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "tuvoz-dae95",
  storageBucket: "tuvoz-dae95.firebasestorage.app",
  messagingSenderId: "21285165787",
  appId: "1:21285165787:web:d7f84940999df2935e4afe"
};

// Inicializa Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app); // Usar getFirestore para obtener la instancia de Firestore

document.getElementById('contactForm').addEventListener('submit', async function (e) {
  e.preventDefault();

  // Obtiene los valores del formulario
  const name = document.getElementById('name').value;
  const email = document.getElementById('email').value;
  const message = document.getElementById('message').value;

  const successMessage = document.getElementById('messageSuccess');
  const errorMessage = document.getElementById('messageError');

  // Limpia los mensajes anteriores
  successMessage.style.display = 'none';
  errorMessage.style.display = 'none';

  try {
    // Aquí guardamos los datos en Firestore
    const feedbackData = {
      name: name,
      email: email || "No proporcionado",  // Si no se proporciona correo, se guarda un valor por defecto
      message: message,
      date: new Date()
    };

    // Guardar el mensaje en Firestore
    await addDoc(collection(db, 'feedback'), feedbackData);

    // Mostrar mensaje de éxito
    successMessage.textContent = '¡Gracias por tu mensaje! Te responderemos pronto.';
    successMessage.style.display = 'block';

    // Limpiar el formulario
    document.getElementById('contactForm').reset();
  } catch (error) {
    // Si hay un error, muestra un mensaje de error
    errorMessage.textContent = 'Hubo un error al enviar tu mensaje. Por favor, inténtalo nuevamente.';
    errorMessage.style.display = 'block';
  }
});

  </script>

</body>
</html>
